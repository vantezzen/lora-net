(this["webpackJsonplora-net"]=this["webpackJsonplora-net"]||[]).push([[0],{27:function(e,t,n){},28:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),s=n(20),a=n.n(s),c=(n(27),n(12)),o=(n(28),n(4)),l=n(5),u=function(){function e(){Object(o.a)(this,e),this.entries=[],this.updateListeners=[],this.add({isSender:!0,message:"Wilkommen im Terminal!"})}return Object(l.a)(e,[{key:"add",value:function(e){this.entries.push({isSender:e.isSender,message:"[".concat((new Date).toLocaleTimeString(),"] ").concat(e.message)}),this.updateListeners.forEach((function(e){return e()}))}},{key:"getAll",value:function(){return this.entries}},{key:"onUpdate",value:function(e){this.updateListeners.push(e)}},{key:"removeUpdateListener",value:function(e){this.updateListeners=this.updateListeners.filter((function(t){return t!==e}))}}]),e}(),d=n(8),h=n(7),f=n(10),p=n(17),b=n(41),j=n(40),m=n(39),v=n(38),g=n(22),x=n(6),O=n.n(x),y=n(9),k=function(){function e(t){var n=this;Object(o.a)(this,e),this.isConnected=!1,this.connectionStart=new Date,this.terminal=void 0,this.dataListeners=[],this.terminal=t,this.log("Mock Interface wurde erstellt"),this.onData((function(e){n.terminal.add({isSender:!1,message:"> ".concat(e)})}))}return Object(l.a)(e,[{key:"log",value:function(e){this.terminal.add({isSender:!1,message:"| Mock: ".concat(e)})}},{key:"getConnectionType",value:function(){return"Mock"}},{key:"connect",value:function(){var e=this;return new Promise((function(t){e.log("Verbinde in 1,5s"),setTimeout((function(){e.log("Verbindung hergestellt"),e.isConnected=!0,e.connectionStart=new Date,t(!0)}),1500)}))}},{key:"disconnect",value:function(){var e=this;return new Promise((function(t){e.log("Trenne Verbindung in 1,5s"),setTimeout((function(){e.log("Verbindung getrennt"),e.isConnected=!1,e.connectionStart=new Date,t(!0)}),1500)}))}},{key:"getConnectionInfo",value:function(){return!!this.isConnected&&{name:"Mock Device",icon:"Code",connectionStart:this.connectionStart}}},{key:"getIsConnected",value:function(){return this.isConnected}},{key:"send",value:function(){var e=Object(y.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.terminal.add({isSender:!0,message:t}),this.dataListeners.forEach((function(e){return e("AT+OK")}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onData",value:function(e){this.dataListeners.push(e)}}]),e}(),S=function(){function e(t){Object(o.a)(this,e),this.connectionStart=new Date,this.terminal=void 0,this.dataListeners=[],this.port=void 0,this.writer=void 0,this.reader=void 0,this.terminal=t,this.log("Neue WebSerial Verbindung erstellt")}return Object(l.a)(e,[{key:"getConnectionType",value:function(){return"WebSerial"}},{key:"log",value:function(e){this.terminal.add({isSender:!1,message:"| WebSerial: ".concat(e)})}},{key:"processData",value:function(e){var t=String.fromCharCode.apply(null,Array.from(e));this.terminal.add({isSender:!1,message:"> ".concat(t)}),this.dataListeners.forEach((function(e){return e(t)}))}},{key:"startReader",value:function(){var e,t=this;console.log("WebSerial waiting for next data"),null===(e=this.reader)||void 0===e||e.read().then((function(e){var n=e.value,r=e.done;console.log("Reader signal read",{value:n,done:r}),r?t.log("WebSerial Reader beendet - done signal empfangen"):(n&&t.processData(n),t.startReader())}))}},{key:"connect",value:function(){var e=Object(y.a)(O.a.mark((function e(){var t=this;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.log("Stelle WebSerial Verbindung her..."),e.next=3,navigator.serial.requestPort().catch((function(){t.log("WebSerial Verbindung fehlgeschlagen")}));case 3:if(this.port=e.sent,this.port){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,this.port.open({baudRate:9600});case 8:return this.port.writable?this.writer=this.port.writable.getWriter():this.log("WebSerial Ger\xe4t unterst\xfctzt kein Write!"),this.port.readable?(this.reader=this.port.readable.getReader(),this.startReader()):this.log("WebSerial Ger\xe4t unterst\xfctzt kein Read!"),this.log("WebSerial Ger\xe4t eingerichtet"),this.connectionStart=new Date,e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=Object(y.a)(O.a.mark((function e(){var t,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.log("Trenne Verbindung..."),!this.port){e.next=8;break}return e.next=4,null===(t=this.reader)||void 0===t?void 0:t.cancel();case 4:return e.next=6,null===(n=this.writer)||void 0===n?void 0:n.abort();case 6:return e.next=8,this.port.close();case 8:return this.port=void 0,this.log("Verbindung getrennt"),e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getConnectionInfo",value:function(){return{name:this.port?"".concat(this.port.getInfo().usbVendorId?"USB":"Bluetooth"," Ger\xe4t"):"Unbekannt",icon:"Radio",connectionStart:this.connectionStart}}},{key:"getIsConnected",value:function(){return!!this.port}},{key:"send",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=this.writer)||void 0===n?void 0:n.write((new TextEncoder).encode("".concat(t,"\n")));case 2:this.terminal.add({isSender:!0,message:t});case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onData",value:function(e){this.dataListeners.push(e)}}]),e}(),w=n(2),N=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={isDisconnecting:!1},r.updateLoop=!1,r.timeAgo=void 0,v.a.addDefaultLocale(g),r.timeAgo=new v.a("de-DE"),r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.updateLoop=setInterval((function(){e.forceUpdate()}),1e3)}},{key:"componentWillUnmount",value:function(){this.updateLoop&&clearInterval(this.updateLoop)}},{key:"setupConnection",value:function(e){var t=this,n=new e(this.props.terminalStore);this.props.setConnection(n),n.connect().then((function(e){e||t.props.setConnection(null),t.props.forceRender()}))}},{key:"renderContent",value:function(){var e=this,t=this.props.connection;if(this.state.isDisconnecting)return Object(w.jsx)("div",{children:Object(w.jsx)("div",{className:"mb-5",children:Object(w.jsx)(b.a,{color:"indigo",dot:!0,size:"large",children:"Trenne Verbindung..."})})});if(t){var n=t.getConnectionInfo();if(!1===n)return Object(w.jsx)("div",{children:Object(w.jsx)("div",{className:"mb-5",children:Object(w.jsx)(b.a,{color:"indigo",dot:!0,size:"large",children:"Verbinde..."})})});var r=f[n.icon];return Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:"mb-5",children:Object(w.jsx)(b.a,{color:"green",dot:!0,size:"large",children:"Verbunden mit Ger\xe4t"})}),Object(w.jsxs)("div",{className:"flex gap-5",children:[Object(w.jsx)("div",{children:Object(w.jsx)(r,{size:40})}),Object(w.jsxs)("div",{className:"w-full",children:[Object(w.jsxs)("p",{children:[Object(w.jsx)("span",{className:"text-gray-500 mr-3",children:"Name:"}),Object(w.jsx)("span",{className:"float-right font-bold",children:n.name})]}),Object(w.jsxs)("p",{children:[Object(w.jsx)("span",{className:"text-gray-500 mr-3",children:"Verbindungszeit:"}),Object(w.jsxs)("span",{className:"float-right font-bold",children:["seit ",this.timeAgo.format(n.connectionStart,"twitter-now")]})]}),Object(w.jsxs)("p",{children:[Object(w.jsx)("span",{className:"text-gray-500 mr-3",children:"Verbindungstyp:"}),Object(w.jsx)("span",{className:"float-right font-bold",children:t.getConnectionType()})]})]})]}),Object(w.jsx)(j.a,{type:"default",className:"mt-5",onClick:function(){e.setState({isDisconnecting:!0}),t.disconnect().then((function(){e.setState({isDisconnecting:!1}),e.props.setConnection(null)}))},children:"Verbindung trennen"})]})}return Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:"mb-5",children:Object(w.jsx)(b.a,{color:"pink",dot:!0,size:"large",children:"Nicht verbunden"})}),Object(w.jsx)(j.a,{onClick:function(){e.setupConnection(S)},className:"m-3",children:"Mit WebSerial Ger\xe4t verbinden"}),Object(w.jsx)(j.a,{className:"m-3",onClick:function(){e.setupConnection(k)},children:"Mit Mock verbinden"})]})}},{key:"render",value:function(){return Object(w.jsx)(m.a,{className:"w-full h-full",title:Object(w.jsxs)("div",{className:"flex items-center gap-3",children:[" ",Object(w.jsx)(p.a,{size:15})," Verbindung "]}),children:this.renderContent()})}}]),n}(i.a.Component),C=n(18),V=n(16),D=function(){return Object(w.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:Object(w.jsxs)("div",{className:"flex items-center flex-col text-gray-400",children:[Object(w.jsx)(p.a,{size:30}),Object(w.jsx)("h3",{className:"text-lg mt-3",children:"Nicht verbunden"})]})})},L=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.connection;return Object(w.jsx)(m.a,{className:"w-full h-full",title:Object(w.jsxs)("div",{className:"flex items-center gap-3",children:[" ",Object(w.jsx)(C.a,{size:15})," Netzwerk "]}),children:e&&e.getIsConnected()?Object(w.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:Object(w.jsxs)("div",{className:"flex items-center flex-col text-gray-400",children:[Object(w.jsx)(V.a,{size:30}),Object(w.jsx)("h3",{className:"text-lg mt-3",children:"Noch nicht eingerichtet"})]})}):Object(w.jsx)(D,{})})}}]),n}(i.a.Component),W=n(11),T=n(19),U=function(e){Object(d.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).outputElement=void 0,r.state={inputVal:""},r.outputElement=i.a.createRef(),r.doUpdate=r.doUpdate.bind(Object(W.a)(r)),r}return Object(l.a)(n,[{key:"scrollOutput",value:function(){var e=this;setTimeout((function(){if(e.outputElement&&e.outputElement.current){var t=e.outputElement.current;t.scrollTop=t.scrollHeight}}),0)}},{key:"doUpdate",value:function(){this.forceUpdate()}},{key:"componentDidMount",value:function(){this.props.terminalStore.onUpdate(this.doUpdate)}},{key:"componentWillUnmount",value:function(){this.props.terminalStore.removeUpdateListener(this.doUpdate)}},{key:"render",value:function(){var e=this;return this.scrollOutput(),Object(w.jsx)(m.a,{className:"w-full h-full",title:Object(w.jsxs)("div",{className:"flex items-center gap-3",children:[" ",Object(w.jsx)(T.a,{size:15})," Terminal "]}),children:Object(w.jsxs)("div",{className:"flex flex-col overflow-scroll h-full",children:[Object(w.jsx)("div",{className:"overflow-auto font-mono text-xs flex-grow pb-1",ref:this.outputElement,children:this.props.terminalStore.getAll().map((function(e,t){return Object(w.jsxs)("span",{className:e.isSender?"":"text-gray-400",children:[e.message,Object(w.jsx)("br",{})]},t)}))}),Object(w.jsx)("div",{className:"border-t flex-shrink-0 py-1",style:{borderColor:"#2a2a2a"},children:Object(w.jsx)("input",{type:"text",className:" bg-transparent w-full h-full outline-none border border-transparent rounded focus:border-gray-600 p-2 font-mono text-xs ",placeholder:"Kommandos hier eingeben...",value:this.state.inputVal,onChange:function(t){e.setState({inputVal:t.target.value})},onKeyDown:function(t){var n;"Enter"===t.code&&!t.shiftKey&&e.state.inputVal.length>0&&(t.preventDefault(),null===(n=e.props.connection)||void 0===n||n.send(e.state.inputVal),e.setState({inputVal:""}))}})})]})})}}]),n}(i.a.Component),z=new u;var E=function(){var e=Object(r.useState)(null),t=Object(c.a)(e,2),n=t[0],i=t[1],s=Object(r.useState)(z),a=Object(c.a)(s,1)[0],o=Object(r.useState)({}),l=Object(c.a)(o,2)[1];return Object(w.jsxs)("div",{className:"min-w-screen h-screen grid grid-rows-2 dark text-gray-100",style:{backgroundColor:"#2a2a2a"},children:[Object(w.jsxs)("div",{className:"p-5 pb-0 grid grid-cols-2 lg:grid-cols-3 gap-5",children:[Object(w.jsx)(N,{connection:n,setConnection:i,forceRender:function(){l({})},terminalStore:a}),Object(w.jsx)("div",{className:"lg:col-span-2",children:Object(w.jsx)(L,{connection:n})})]}),Object(w.jsx)("div",{className:"p-5",children:Object(w.jsx)(U,{connection:n,terminalStore:a})})]})};a.a.render(Object(w.jsx)(i.a.StrictMode,{children:Object(w.jsx)(E,{})}),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.5f78f610.chunk.js.map